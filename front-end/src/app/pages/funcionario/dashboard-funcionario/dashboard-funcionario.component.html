<div class="dashboard-content">
  
  <!-- ====== HEADER KPI GRID ====== -->
  <section class="grid header-grid">

    <!-- XP Atual -->
    <mat-card class="card kpi">
      <div class="kpi-header">
        <mat-icon>bolt</mat-icon>
        <span>XP Atual</span>
      </div>

      <div class="kpi-value">{{ xpAtual | number }}</div>

      <mat-progress-bar mode="determinate"
                        [value]="progressoNivel"></mat-progress-bar>

      <div class="kpi-foot">
        {{ xpAtual }} / {{ xpParaProximoNivel }} XP para nível {{ nivel + 1 }}
      </div>
    </mat-card>

    <!-- Nível -->
    <mat-card class="card kpi">
      <div class="kpi-header">
        <mat-icon>military_tech</mat-icon>
        <span>Nível</span>
      </div>

      <div class="kpi-value">Lvl {{ nivel }}</div>

      <div class="kpi-foot">
        Próximo badge: <strong>{{ proximoBadge.nome }}</strong>
      </div>

      <div class="badge-row">
        <mat-chip-set>
          <mat-chip color="primary" class="selected-chip">
            <mat-icon>emoji_events</mat-icon>
            {{ proximoBadge.nome }}
          </mat-chip>
          <mat-chip>{{ proximoBadge.requisitoXp }} XP</mat-chip>
        </mat-chip-set>
      </div>
    </mat-card>

    <!-- Progresso -->
    <mat-card class="card kpi">
      <div class="kpi-header">
        <mat-icon>percent</mat-icon>
        <span>Progresso</span>
      </div>

      <div class="kpi-value">{{ progressoNivel | number:'1.0-0' }}%</div>

      <mat-progress-bar mode="determinate"
                        [value]="progressoNivel"></mat-progress-bar>

      <div class="kpi-foot">Rumo ao próximo nível!</div>
    </mat-card>

  </section>


  <!-- ====== COURSES GRID ====== -->
  <section class="grid courses-grid">

    <!-- CURSOS EM ANDAMENTO -->
    <mat-card class="card">
      <mat-card-title>Cursos em andamento</mat-card-title>
      <mat-divider></mat-divider>

      <mat-list>
        <mat-list-item *ngFor="let c of cursosEmAndamento">

          <mat-icon matListItemIcon>play_circle</mat-icon>

          <div class="item-info">
            <div class="item-title">{{ c.titulo }}</div>
            <div class="item-category muted">{{ c.categoria }}</div>

            <div class="progress-row">
              <span class="pct">{{ c.progresso }}%</span>
              <mat-progress-bar mode="determinate"
                                [value]="c.progresso"></mat-progress-bar>
            </div>
          </div>

        </mat-list-item>
      </mat-list>

      <button mat-raised-button color="primary"
              class="btn-continuar w-full"
              (click)="continuarCurso()">
        Continuar
      </button>
    </mat-card>



    <!-- CURSOS CONCLUÍDOS -->
    <mat-card class="card">
      <mat-card-title>Cursos concluídos</mat-card-title>
      <mat-divider></mat-divider>

      <mat-list>
        <mat-list-item *ngFor="let c of cursosConcluidos">

          <mat-icon matListItemIcon>check_circle</mat-icon>

          <div class="item-info">
            <div class="item-title">{{ c.titulo }}</div>
            <div class="item-category muted">{{ c.categoria }}</div>
          </div>

          <button mat-stroked-button color="primary"
                  class="btn-certificado"
                  (click)="baixarCertificado(c)">
            <mat-icon>workspace_premium</mat-icon>
            Certificado
          </button>

        </mat-list-item>
      </mat-list>
    </mat-card>



    <!-- CURSOS DISPONÍVEIS -->
    <mat-card class="card">
      <mat-card-title>Cursos disponíveis</mat-card-title>
      <mat-divider></mat-divider>

      <mat-list>
        <mat-list-item *ngFor="let c of cursosDisponiveis">

          <mat-icon matListItemIcon>school</mat-icon>

          <div class="item-info">
            <div class="item-title">{{ c.titulo }}</div>
            <div class="item-category muted">{{ c.categoria }}</div>
          </div>

          <button mat-raised-button color="primary"
                  class="btn-iniciar"
                  (click)="iniciarCurso(c)">
            Iniciar
          </button>

        </mat-list-item>
      </mat-list>
    </mat-card>

  </section>



  <!-- ====== BOTTOM GRID ====== -->
  <section class="grid bottom-grid">

    <!-- RANKING -->
    <mat-card class="card">
      <mat-card-title>Ranking do Departamento</mat-card-title>
      <mat-divider></mat-divider>

      <mat-list>
        <mat-list-item *ngFor="let r of ranking; let i = index">

          <div matListItemIcon class="rank-badge">{{ i + 1 }}</div>

          <div class="item-info">
            <div class="item-title">{{ r.nome }}</div>
            <div class="item-category muted">{{ r.cargo }}</div>
          </div>

          <div class="xp">{{ r.xp | number }} XP</div>

        </mat-list-item>
      </mat-list>
    </mat-card>



    <!-- ATIVIDADES -->
    <mat-card class="card">
      <mat-card-title>Últimas atividades</mat-card-title>
      <mat-divider></mat-divider>

      <mat-list>
        <mat-list-item *ngFor="let a of atividades">

          <mat-icon matListItemIcon>{{ a.icone }}</mat-icon>

          <div class="item-info">
            <div class="item-title">{{ a.titulo }}</div>
            <div class="item-category muted">{{ a.data | date:'short' }}</div>
          </div>

          <div class="xp" *ngIf="a.xpDelta !== 0">
            <mat-chip color="primary" class="selected-chip">
              {{ a.xpDelta >= 0 ? '+' : ''}}{{ a.xpDelta }} XP
            </mat-chip>
          </div>

        </mat-list-item>
      </mat-list>

    </mat-card>

  </section>

</div>
